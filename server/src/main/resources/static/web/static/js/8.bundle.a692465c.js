(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{286:function(e,t,o){},698:function(e,t,o){"use strict";var s=o(286);o.n(s).a},717:function(e,t,o){"use strict";o.r(t);var s=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("section",{staticClass:"table-container"},[o("div",{staticClass:"toolbar"},[o("div",{staticClass:"placeholder"}),e._v(" "),o("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.rowAdd}},[e._v("新增")]),e._v(" "),o("br")],1),e._v(" "),o("el-table",{attrs:{data:e.tableData}},[o("el-table-column",{attrs:{prop:"roleName",label:"角色","min-width":"100",align:"center"}}),e._v(" "),o("el-table-column",{attrs:{label:"操作",width:"150",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{attrs:{type:"text"},on:{click:function(o){return e.authEdit(t.row)}}},[e._v("编辑")])]}}])})],1),e._v(" "),o("el-dialog",{attrs:{visible:e.visible.editAuthDlg,width:"50%",title:"编辑权限","close-on-click-modal":!1},on:{"update:visible":function(t){return e.$set(e.visible,"editAuthDlg",t)}}},[o("el-form",{attrs:{"label-width":"80px","label-position":"left"}},[o("el-button-group",[o("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.selectM("GET")}}},[e._v("GET")]),e._v(" "),o("el-button",{attrs:{type:"success"},on:{click:function(t){return e.selectM("POST")}}},[e._v("POST")]),e._v(" "),o("el-button",{attrs:{type:"warning"},on:{click:function(t){return e.selectM("PUT")}}},[e._v("PUT")]),e._v(" "),o("el-button",{attrs:{type:"danger"},on:{click:function(t){return e.selectM("DELETE")}}},[e._v("DELETE")]),e._v(" "),o("el-button",{on:{click:function(t){return e.selectM("CLEAN")}}},[e._v("全不选")]),e._v(" "),o("el-button",{attrs:{type:"info"},on:{click:e.roleRefresh}},[e._v("更新角色权限")])],1),e._v(" "),o("el-tree",{ref:"tree",attrs:{data:e.authData,props:e.authProps,"node-key":"modularId","show-checkbox":"","default-expanded-keys":e.defaultExpand,"check-on-click-node":"","expand-on-click-node":!1},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.node,a=t.data;return o("div",{staticClass:"tree-node"},["GET"===a.pageMethod?o("div",{staticClass:"nodeGET"},[o("span",[e._v(e._s(s.label))])]):e._e(),e._v(" "),"POST"===a.pageMethod?o("div",{staticClass:"nodePOST"},[o("span",[e._v(e._s(s.label))])]):e._e(),e._v(" "),"PUT"===a.pageMethod?o("div",{staticClass:"nodePUT"},[o("span",[e._v(e._s(s.label))])]):e._e(),e._v(" "),"DELETE"===a.pageMethod?o("div",{staticClass:"nodeDELETE"},[o("span",[e._v(e._s(s.label))])]):e._e(),e._v(" "),"ALL"===a.pageMethod?o("div",[o("span",[e._v(e._s(s.label))])]):e._e()])}}])})],1),e._v(" "),o("span",{attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.visible.editAuthDlg=!1}}},[e._v("取消")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:e.authEditSubmit}},[e._v("确定")])],1)],1),e._v(" "),o("el-dialog",{attrs:{visible:e.visible.addDlg,width:"30%",title:"添加角色","close-on-click-modal":!1},on:{"update:visible":function(t){return e.$set(e.visible,"addDlg",t)},opened:e.rowAddOpend}},[o("el-form",{ref:"addForm",attrs:{"label-width":"120px","label-position":"right",model:e.addForm,rules:e.rules,size:"mini"}},[o("el-form-item",{attrs:{prop:"roleName",label:"角色名"}},[o("el-input",{model:{value:e.addForm.roleName,callback:function(t){e.$set(e.addForm,"roleName",t)},expression:"addForm.roleName"}})],1)],1),e._v(" "),o("div",{attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.visible.addDlg=!1}}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:e.roleAddSubmit}},[e._v("确 定")])],1)],1)],1)};s._withStripped=!0;var a={data:function(){return{tableData:null,authData:null,defaultExpand:[],editFormRoleId:0,authProps:{label:"pageName"},visible:{addDlg:!1,editAuthDlg:!1},addForm:{roleName:null},rules:{roleName:[{required:!0,message:"请输入",trigger:"blur"}]},selNodes:[],pageMethod:{PUT:[],POST:[],GET:[],DELETE:[]}}},methods:{tableListGet:function(){var e=this;this.$API.RoleGet().then(function(t){e.tableData=t.authRoles,e.authData=[t.authModulars],e.authNodeInit([t.authModulars])})},authNodeInit:function(e){for(var t in e)e[t].children?this.authNodeInit(e[t].children):"POST"==e[t].pageMethod?this.pageMethod.POST.push(e[t]):"GET"==e[t].pageMethod?this.pageMethod.GET.push(e[t]):"PUT"==e[t].pageMethod?this.pageMethod.PUT.push(e[t]):"DELETE"==e[t].pageMethod&&this.pageMethod.DELETE.push(e[t])},authSet:function(e){for(var t in e)e[t].children?this.authSet(e[t].children):this.selNodes.push(e[t])},rowAdd:function(){this.visible.addDlg=!0},rowAddOpend:function(){this.$refs.addForm.resetFields()},roleAddSubmit:function(){var e=this;this.$refs.addForm.validate(function(t){if(t){var o={roleName:e.addForm.roleName};e.$API.RoleAdd(o).then(function(t){e.tableListGet(),e.visible.addDlg=!1})}})},authEdit:function(e){var t=this;this.editFormRoleId=e.roleId;var o={json:{roleId:e.roleId}};this.visible.editAuthDlg=!0,this.$API.RoleGetById(o).then(function(e){t.selNodes=[],t.authSet([e.authModulars]),t.$refs.tree.setCheckedNodes(t.selNodes)})},authEditSubmit:function(){var e=this,t={modularIds:this.$refs.tree.getCheckedKeys(),roleId:this.editFormRoleId};this.$API.RoleEdit(t).then(function(t){e.visible.editAuthDlg=!1})},roleRefresh:function(){var e=this;this.$API.RoleRefresh().then(function(t){e.$message({message:"更新成功",type:"success"})})},selectM:function(e){var t=this.$refs.tree.getCheckedNodes();"POST"==e?(t=t.concat(this.pageMethod.POST),this.$refs.tree.setCheckedNodes(t)):"GET"==e?(t=t.concat(this.pageMethod.GET),this.$refs.tree.setCheckedNodes(t)):"PUT"==e?(t=t.concat(this.pageMethod.PUT),this.$refs.tree.setCheckedNodes(t)):"DELETE"==e?(t=t.concat(this.pageMethod.DELETE),this.$refs.tree.setCheckedNodes(t)):"CLEAN"==e&&this.$refs.tree.setCheckedNodes([])}},mounted:function(){this.tableListGet()}},i=(o(698),o(8)),l=Object(i.a)(a,s,[],!1,null,"850a75a8",null);l.options.__file="src/views/System/Role.vue";t.default=l.exports}}]);