(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{250:function(e,t,i){},374:function(e,t,i){"use strict";var n=i(250);i.n(n).a},712:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("section",{staticClass:"table-container"},[i("div",{staticClass:"toolbar"},[i("el-select",{attrs:{placeholder:"请选择省",clearable:""},on:{change:e.cityListGet},model:{value:e.provinceId,callback:function(t){e.provinceId=t},expression:"provinceId"}},e._l(e.locationPOptions,function(e,t){return i("el-option",{key:t,attrs:{label:e.name,value:e.id}})}),1),e._v(" "),i("el-select",{attrs:{placeholder:"请选择市",clearable:""},model:{value:e.cityId,callback:function(t){e.cityId=t},expression:"cityId"}},e._l(e.locationCOptions,function(e,t){return i("el-option",{key:t,attrs:{label:e.name,value:e.id}})}),1),e._v(" "),i("el-select",{attrs:{placeholder:"台站类型",clearable:""},model:{value:e.siteTypeId,callback:function(t){e.siteTypeId=t},expression:"siteTypeId"}},e._l(e.siteTypeOptions,function(e,t){return i("el-option",{key:t,attrs:{label:e.siteTypeName,value:e.siteTypeId}})}),1),e._v(" "),i("el-button",{attrs:{icon:"el-icon-search"},on:{click:e.tableListGet}}),e._v(" "),i("div",{staticClass:"placeholder"})],1),e._v(" "),i("div",{staticClass:"table"},[i("el-table",{attrs:{data:e.tableData}},[i("el-table-column",{attrs:{prop:"siteName",label:"台站名称","min-width":"100",align:"center"}}),e._v(" "),i("el-table-column",{attrs:{prop:"siteLongitude",label:"站点经度","min-width":"100",align:"center"}}),e._v(" "),i("el-table-column",{attrs:{prop:"siteLatitude",label:"站点纬度","min-width":"100",align:"center"}}),e._v(" "),i("el-table-column",{attrs:{prop:"siteAddress",label:"台站地址","min-width":"200",align:"center"}}),e._v(" "),i("el-table-column",{attrs:{label:"所属区域","min-width":"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.provinceName)+e._s(t.row.cityName))])]}}])}),e._v(" "),i("el-table-column",{attrs:{prop:"siteCompanyName",label:"所属单位","min-width":"100",align:"center"}}),e._v(" "),i("el-table-column",{attrs:{prop:"siteTypeName",label:"站点类型","min-width":"100",align:"center"}}),e._v(" "),i("el-table-column",{attrs:{prop:"siteManufactureTime",label:"出厂日期",formatter:e.dateFormat,"min-width":"100",align:"center"}}),e._v(" "),i("el-table-column",{attrs:{prop:"itemNumberName",label:"项目编号","min-width":"100",align:"center"}}),e._v(" "),i("el-table-column",{attrs:{prop:"coreEquipment",label:"核心设备","min-width":"100",align:"center"}}),e._v(" "),i("el-table-column",{attrs:{label:"检查说明",fixed:"right","min-width":"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{type:"text"},on:{click:function(i){return e.rowEdit(t.row)}}},[e._v("配置")])]}}])})],1)],1),e._v(" "),i("div",{staticClass:"pagination"},[i("div",{staticClass:"placeholder"}),e._v(" "),i("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:e.tableTotal},on:{"current-change":e.tablePageChange}})],1),e._v(" "),i("el-dialog",{attrs:{title:"配置",visible:e.visible.editDlg,width:"70%","close-on-click-modal":!1},on:{"update:visible":function(t){return e.$set(e.visible,"editDlg",t)},opened:e.rowEditOpened}},[i("el-tree",{ref:"tree",attrs:{data:e.treeData,props:e.treeDataProps,"show-checkbox":"","expand-on-click-node":!1,"node-key":"checkItemId","default-expanded-keys":e.defaultExpandNode},on:{"node-expand":e.updateExpandNode},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.node,l=t.data;return[i("div",{staticClass:"tree-node"},[i("div",{staticStyle:{flex:"auto"}},[e._v(e._s(n.label))]),e._v(" "),i("div",{staticStyle:{flex:"none"}},[l.level<4?i("el-button",{staticStyle:{color:"#49CC90"},attrs:{type:"text"},on:{click:function(t){return e.nodeAdd(l)}}},[e._v("添加")]):e._e(),e._v(" "),i("el-button",{staticStyle:{color:"#409EFF"},attrs:{type:"text"},on:{click:function(t){return e.nodeEdit(l)}}},[e._v("编辑")]),e._v(" "),i("el-button",{staticStyle:{color:"#F93E3E"},attrs:{type:"text"},on:{click:function(t){return e.nodeDelete(n,l)}}},[e._v("删除")])],1)])]}}])}),e._v(" "),i("div",{attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.visible.editDlg=!1}}},[e._v("关 闭")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.rowEditSubmit}},[e._v("保 存")])],1)],1),e._v(" "),i("el-dialog",{attrs:{visible:e.visible.addTreeDlg,width:"20%","close-on-click-modal":!1},on:{"update:visible":function(t){return e.$set(e.visible,"addTreeDlg",t)}}},[i("div",{staticStyle:{display:"flex","justify-content":"space-around"}},[i("el-input",{staticStyle:{"padding-right":"10px"},attrs:{size:"mini"},model:{value:e.addForm.checkItemName,callback:function(t){e.$set(e.addForm,"checkItemName",t)},expression:"addForm.checkItemName"}}),e._v(" "),i("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.nodeAddSubmit()}}},[e._v("确定")])],1)]),e._v(" "),i("el-dialog",{attrs:{visible:e.visible.editTreeDlg,width:"20%","close-on-click-modal":!1},on:{"update:visible":function(t){return e.$set(e.visible,"editTreeDlg",t)}}},[i("div",{staticStyle:{display:"flex","justify-content":"space-around"}},[i("el-input",{staticStyle:{"padding-right":"10px"},attrs:{size:"mini"},model:{value:e.editForm.checkItemName,callback:function(t){e.$set(e.editForm,"checkItemName",t)},expression:"editForm.checkItemName"}}),e._v(" "),i("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.nodeEditSubmit()}}},[e._v("确定")])],1)])],1)};n._withStripped=!0;var l={data:function(){return{tableData:null,tablePage:1,tableTotal:1,provinceId:null,cityId:null,siteTypeId:null,visible:{editDlg:!1,addTreeDlg:!1,editTreeDlg:!1},locationPOptions:[],locationCOptions:[],siteTypeOptions:[],treeData:null,treeDataProps:{label:"checkItemName",children:"child"},siteId:null,addForm:{checkItemName:null,level:null,parentId:null},editForm:{checkItemId:null,checkItemName:null,level:null,parentId:null},defaultExpandNode:[],treeNodeArray:[],treeNodeSelectedArray:[]}},methods:{tableListGet:function(){var e=this;this.$API.TemplateGet(null,this.provinceId||0,this.cityId||0,this.siteTypeId||0,this.tablePage).then(function(t){e.tableData=t.records,e.tableTotal=t.total})},cityListGet:function(){var e=this;this.cityId=null,this.provinceId?this.$API.LocationGetC({pid:this.provinceId}).then(function(t){e.locationCOptions=t}):this.locationCOptions=[]},createTreeNodeArray:function(e){for(var t in e)null!=e[t].child&&0!==e[t].child.length?this.createTreeNodeArray(e[t].child):this.treeNodeArray.push(e[t])},rowEdit:function(e){var t=this;this.siteId=e.siteId,this.$API.TemplateGetById(null,e.siteId).then(function(e){t.treeData=e.voCheckItems,t.visible.editDlg=!0})},rowEditOpened:function(){var e=this;this.treeNodeArray=[],this.createTreeNodeArray(this.treeData),this.treeNodeSelectedArray=this.treeNodeArray.filter(function(e){return e.select}),this.$nextTick(function(){e.$refs.tree.setCheckedNodes(e.treeNodeSelectedArray)})},rowEditSubmit:function(){var e=this,t={siteCheckItems:JSON.parse(JSON.stringify(this.$refs.tree.getCheckedNodes())),siteId:this.siteId};this.$API.TemplateEdit(t).then(function(t){e.visible.editDlg=!1})},nodeAdd:function(e){this.addForm.level=e.level+1,this.addForm.parentId=e.checkItemId,this.addForm.checkItemName=null,this.visible.addTreeDlg=!0},nodeAddSubmit:function(){var e=this,t={checkItemName:this.addForm.checkItemName,level:this.addForm.level,parentId:this.addForm.parentId};this.$API.TemplateAdd(t).then(function(t){e.visible.addTreeDlg=!1,e.$API.TemplateGetById(null,e.siteId).then(function(t){e.treeData=t.voCheckItems,e.rowEditOpened()})})},nodeEdit:function(e){this.editForm.checkItemId=e.checkItemId,this.editForm.checkItemName=e.checkItemName,this.visible.editTreeDlg=!0},nodeEditSubmit:function(){var e=this,t={checkItemId:this.editForm.checkItemId,checkItemName:this.editForm.checkItemName};this.$API.TemplateEditNodeName(t).then(function(t){e.visible.editTreeDlg=!1,e.$API.TemplateGetById(null,e.siteId).then(function(t){e.treeData=t.voCheckItems,e.rowEditOpened()})})},nodeDelete:function(e,t){var i=this;this.$confirm("是否删除该项？",{type:"warning"}).then(function(){i.$API.TemplateDelete(null,t.checkItemId).then(function(e){i.$API.TemplateGetById(null,i.siteId).then(function(e){i.treeData=e.voCheckItems,i.rowEditOpened()})})}).catch(function(){})},updateExpandNode:function(e){this.defaultExpandNode=[e.checkItemId]},dateFormat:function(e,t,i,n){return this.$format(i)},tablePageChange:function(e){this.tablePage=e,this.tableListGet()}},mounted:function(){var e=this;this.$API.LocationGetP().then(function(t){e.locationPOptions=t}),this.$API.SiteTypeGet().then(function(t){e.siteTypeOptions=t}),this.tableListGet()}},a=(i(374),i(8)),o=Object(a.a)(l,n,[],!1,null,"7340cf76",null);o.options.__file="src/views/Template/Template.vue";t.default=o.exports}}]);